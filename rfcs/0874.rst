Add 4 New Rounding Modes To Round() Function
============================================

:PHP-RFC: 0874
:Title: Add 4 New Rounding Modes To Round() Function
:Author: Jorg Sowa <jorg.sowa@gmail.com>
:Status: Implemented
:Type: Standards Track
:Created: 2023-08-31
:PHP-Version: 8.4
:Version: 1.0

Introduction
------------

The RFC proposes to add 4 new modes to the round() function.

-  `PHP_ROUND_CEILING <https://en.wikipedia.org/wiki/Rounding#Rounding_up>`__,
-  `PHP_ROUND_FLOOR <https://en.wikipedia.org/wiki/Rounding#Rounding_down>`__,
-  `PHP_ROUND_AWAY_FROM_ZERO <https://en.wikipedia.org/wiki/Rounding#Rounding_away_from_zero>`__,
-  `PHP_ROUND_TOWARD_ZERO <https://en.wikipedia.org/wiki/Rounding#Rounding_toward_zero>`__.

..

   **Note:** The aforementioned have been transformed into an enum in a
   `follow-up
   RFC <https://wiki.php.net/rfc/correctly_name_the_rounding_mode_and_make_it_an_enum>`__.

Two first comments on the `documentation page of the
round() <https://www.php.net/manual/en/function.round.php>`__ function
are related to the missing modes of rounding. The first comment has an
outstanding number of 309 votes.

Moreover, the
`NumberFormatter <https://www.php.net/manual/en/class.numberformatter.php>`__
already implements 4 new proposed modes known as ROUND_CEILING,
ROUND_FLOOR, ROUND_DOWN, ROUND_UP.

Proposal
--------

Adding 4 new constants for the rounding modes of function round():

-  PHP_ROUND_CEILING - rounds num to the nearest integer bigger than
   num,
-  PHP_ROUND_FLOOR - rounds num to the nearest integer lower than num,
-  PHP_ROUND_AWAY_FROM_ZERO - rounds num away from zero,
-  PHP_ROUND_TOWARD_ZERO - rounds num towards zero.

Creating two aliases of constants from Intl extension to have consistent
naming for rounding modes:

-  ROUND_TOWARD_ZERO (equivalent of PHP_ROUND_TOWARD_ZERO) alias of
   `ROUND_DOWN <https://www.php.net/manual/en/class.numberformatter.php#numberformatter.constants.round-down>`__
-  ROUND_AWAY_FROM_ZERO (equivalent of PHP_ROUND_AWAY_FROM_ZERO) alias
   of
   `ROUND_UP <https://www.php.net/manual/en/class.numberformatter.php#numberformatter.constants.round-up>`__

Backward Incompatible Changes
-----------------------------

None

Proposed PHP Versions
---------------------

8.4

Questions
---------

Why not use functions ceil() and floor()?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The functions ceil() and floor() round numbers to the full integer,
while the function round() rounds the number by given precision.
Implementing new rounding modes we get equivalent of those functions
using round() with 0 as precision.

.. code:: php

   ceil($number) === round($number, 0, PHP_ROUND_CEILING); //true
   floor($number) === round($number, 0, PHP_ROUND_FLOOR); //true

Why not the names PHP_ROUND_UP and PHP_ROUND_DOWN?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Such constants already exist in the
`NumberFormatter <https://www.php.net/manual/en/class.numberformatter.php>`__
and represent rounding modes 'away from zero' and 'toward zero'. However
the names rounding up and down are ambiguous. They may be easily
confused with the rounding ceiling/floor, while the terms away
from/toward zero are distinct.

Those constants would be deprecated and replaced with their
corresponding aliases: ROUND_TOWARD_ZERO and ROUND_AWAY_FROM_ZERO.

Why not the enum implementation for the rounding modes?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

As this is extension of the existing modes we should add complementary
modes to the existing constants instead implementing new Enum. This way
enum is an addition to the new constants and is not included into this
RFC.

Proposed Voting Choices
-----------------------

As per the voting RFC a yes/no vote with a 2/3 majority is needed for
this proposal to be accepted.

Voting started on 2023-11-15 and will end on 2023-11-30 00:00 GMT.

Question: Implement 4 new rounding modes to \`round()\` function
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Voting Choices
^^^^^^^^^^^^^^

-  Yes
-  No

--------------

If the first voting is not accepted the result of the second voting will
be ignored.

Question: Create aliases for Intl extension constants ROUND_UP and ROUND_DOWN: ROUND_AWAY_FROM_ZERO and ROUND_TOWARD_ZERO
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. _voting-choices-1:

Voting Choices
^^^^^^^^^^^^^^

-  Yes
-  No

Implementation
--------------

GitHub pull request: https://github.com/php/php-src/pull/12056

References
----------

Links to external references, discussions or RFCs

Rejected Features
-----------------

Keep this updated with features that were discussed on the mail lists.

Additional Metadata
-------------------

:Implementation: https://github.com/php/php-src/pull/12056
:Original Authors: Jorg Sowa jorg.sowa@gmail.com
:Original PHP Version: PHP 8.4
:Slug: new_rounding_modes_to_round_function
:Wiki URL: https://wiki.php.net/rfc/new_rounding_modes_to_round_function
