====== PHP RFC: Add get_error_handler(), get_exception_handler() functions ======
  * Version: 0.9
  * Date: 2025-02-11
  * Author: Arnaud Le Blanc, arnaud.lb@gmail.com
  * Status: Draft
  * First Published at: http://wiki.php.net/rfc/get-error-exception-handler

===== Introduction =====

PHP does not provide a direct way to fetch the currently registered error or exception handlers. Users who need to inspect these handlers must resort to a workaround that temporarily sets a new handler and then immediately restores the previous one:

<PHP>
$current_error_handler = set_error_handler('valid_callback');
restore_error_handler();
</PHP>

This workaround is cumbersome and error-prone.

===== Proposal =====

This RFC proposes two new functions that allow to query the current error/exception handlers in a more direct way:

  * <php>function get_error_handler(): ?callable</php>
  * <php>function get_exception_handler(): ?callable</php>

The functions return the currently defined error and exception handlers, respectively. If no handler is in place, <php>null</php> is returned.

The returned handler is the exact callback value that was passed to ''set_error_handler()'' or ''set_exception_handler()'' to define it.

==== Examples ====

<PHP>
set_error_handler(null);

get_error_handler(); // null
</PHP>

<PHP>
$handler = [$this, 'error_handler'];
set_error_handler($handler);

get_error_handler() === $handler; // true
</PHP>

<PHP>
$new_handler = $this->error_handler(...);
$old_handler = set_error_handler($new_handler);

get_error_handler() === $new_handler; // true

restore_error_handler();

get_error_handler() === $old_handler; // true
</PHP>

===== Backward Incompatible Changes =====

The function names <php>get_error_handler</php>, <php>get_exception_handler</php> will no longer be available within the global namespace.

===== Proposed PHP Version(s) =====

Next 8.x.

===== Proposed Voting Choices =====

Yes or no vote.  2/3 required to pass.

<doodle title="Add the pipe operator?" auth="lbarnaud" voteType="single" closed="true">
   * Yes
   * No
</doodle>

===== Patches and Tests =====

https://github.com/php/php-src/pull/17693

===== Implementation =====

After the project is implemented, this section should contain 
  - the version(s) it was merged into
  - a link to the git commit(s)
  - a link to the PHP manual entry for the feature
  - a link to the language specification section (if any)

===== References =====

https://github.com/symfony/symfony/pull/58372#discussion_r1773407604

===== Rejected Features =====
